import{_ as s}from"./s-empty.B89PqN2E.js";import{A as o,s as e,d as t,v as a,c as i,U as l,o as c,r as n,e as r,f as d,w as u,u as p,a1 as g,j as m,k as f,l as k,p as I,t as _,g as b,z as y,F as h,ab as v,q as x,C as S,i as w,D as j}from"./index-B9abLD3F.js";import{_ as P}from"./su-swiper.STgNvKQ7.js";import{_ as $}from"./s-select-seckill-sku.CCfJRY3u.js";import{S as C}from"./s-layout.Bb9KgRKE.js";import{d as U,k as A,f as M}from"./useGoods.CNfLrev9.js";import{d as V,a as L,_ as N,b as O,c as T,e as q}from"./detail-content-card.C5jdIvzd.js";import{S as z}from"./spu.Cby8Nr3S.js";import{P as D}from"./point.DvvdllU8.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./su-number-box.bg7F02ES.js";import"./min.NYZJvUqb.js";import"./index.CAehB1O5.js";import"./favorite.BozBlweO.js";import"./comment-item.DUh4ouOD.js";import"./uni-rate.DQPzr5r4.js";import"./su-image.BhUL1nHk.js";import"./mp-html.zMPDqqPP.js";const B=F({__name:"point",setup(F){o((s=>({"1335085e":p(B),"5d6e6c02":p(E),d0f2c434:p(G),a9a138d6:p(H),eaae8578:p(J)})));const B=e.$url.css("/static/img/shop/goods/score-bg.png"),E=e.$url.css("/static/img/shop/goods/seckill-btn.png"),G=e.$url.css("/static/img/shop/goods/activity-btn-disabled.png"),H=e.$url.css("/static/img/shop/goods/seckill-tip-bg.png"),J=e.$url.css("/static/img/shop/goods/groupon-tip-bg.png");t((()=>{}));const Z=a({skeletonLoading:!0,goodsInfo:{},showSelectSku:!1,goodsSwiper:[],selectedSku:{},showModel:!1,total:0,price:""});function K(s){Z.selectedSku=s}function Q(s){e.$router.go("/pages/order/confirm",{data:JSON.stringify({order_type:"goods",buy_type:"point",pointActivityId:W.value.id,items:[{skuId:s.id,count:s.count}]})})}const R=i((()=>v(p(W))?{}:e.$platform.share.getShareInfo({title:W.value.name,image:e.$url.cdn(Z.goodsInfo.picUrl),params:{page:"4",query:W.value.id}},{type:"goods",title:W.value.name,image:e.$url.cdn(Z.goodsInfo.picUrl),price:Z.goodsInfo.price,marketPrice:Z.goodsInfo.marketPrice}))),W=l(),X=i((()=>{if(!v(Z.selectedSku)){const s=Z.selectedSku;return{point:s.point,price:s.pointPrice?M(s.pointPrice):""}}return{point:W.value.point,price:W.value.price?M(W.value.price):""}}));i((()=>{let s=`￥${M(Z.goodsInfo.price)}`;if(!v(Z.selectedSku)){const o=Z.selectedSku;s=`${o.point}${o.pointPrice?`+￥${M(o.pointPrice)}`:""}`}return s}));const Y=async s=>{const{data:o}=await z.getSpuDetail(s);o.activity_type=g.POINT.type,Z.goodsInfo=o,Z.goodsInfo.stock=Math.min(o.stock,W.value.stock),Z.goodsSwiper=U(Z.goodsInfo.sliderPicUrls),o.skus.forEach((s=>{const o=W.value.products.find((o=>o.skuId===s.id));o?(s.point=o.point,s.pointPrice=o.price,s.stock=Math.min(s.stock,o.stock),s.limitCount=o.count):s.stock=0})),Z.skeletonLoading=!1};return c((s=>{s.id?(async s=>{const{data:o}=await D.getPointActivity(s);W.value=o,await Y(o.spuId)})(s.id):Z.goodsInfo=null})),(o,t)=>{const a=n(r("s-empty"),s),i=n(r("su-swiper"),P),l=x,c=S,v=w,U=n(r("s-select-seckill-sku"),$),z=j,D=n(r("s-layout"),C);return m(),d(D,{onShareAppMessage:R.value,navbar:"goods"},{default:u((()=>[f(V),Z.skeletonLoading?(m(),d(L,{key:0})):null===Z.goodsInfo||Z.goodsInfo.activity_type!==p(g).POINT.type?(m(),d(a,{key:1,text:"活动不存在或已结束",icon:"/static/soldout-empty.png",showAction:"",actionText:"再逛逛",actionUrl:"/pages/goods/list"})):(m(),k(h,{key:2},[f(v,{class:"detail-swiper-selector"},{default:u((()=>[f(i,{class:"ss-m-b-14",isPreview:"",list:Z.goodsSwiper,dotStyle:"tag",imageMode:"widthFix",dotCur:"bg-mask-40",seizeHeight:750},null,8,["list"]),f(v,{class:"title-card detail-card ss-p-y-40 ss-p-x-20"},{default:u((()=>[f(v,{class:"ss-flex ss-row-between ss-col-center ss-m-b-18"},{default:u((()=>[f(v,{class:"price-box ss-flex ss-col-bottom"},{default:u((()=>[f(l,{src:p(e).$url.static("/static/img/shop/goods/score1.svg"),class:"point-img"},null,8,["src"]),f(c,{class:"point-text ss-m-r-16"},{default:u((()=>[I(_(X.value.point)+" "+_(X.value.price&&0!==X.value.price?`+￥${X.value.price}`:""),1)])),_:1})])),_:1}),f(v,{class:"sales-text"},{default:u((()=>[I(_(p(A)(Z.goodsInfo.sales_show_type,Z.goodsInfo.sales)),1)])),_:1})])),_:1}),Z.goodsInfo.marketPrice?(m(),d(v,{key:0,class:"origin-price-text ss-m-b-60"},{default:u((()=>[I(" 原价：￥"+_(p(M)(Z.selectedSku.marketPrice||Z.goodsInfo.marketPrice)),1)])),_:1})):b("",!0),f(v,{class:"title-text ss-line-2 ss-m-b-6"},{default:u((()=>[I(_(Z.goodsInfo.name||""),1)])),_:1}),f(v,{class:"subtitle-text ss-line-1"},{default:u((()=>[I(_(Z.goodsInfo.introduction),1)])),_:1})])),_:1}),f(v,{class:"detail-cell-card detail-card ss-flex-col"},{default:u((()=>[f(N,{sku:Z.selectedSku,onClick:t[0]||(t[0]=s=>Z.showSelectSku=!0)},null,8,["sku"])])),_:1}),f(U,{modelValue:Z.goodsInfo,"onUpdate:modelValue":t[1]||(t[1]=s=>Z.goodsInfo=s),show:Z.showSelectSku,"single-limit-count":W.value.singleLimitCount,onBuy:Q,onChange:K,onClose:t[2]||(t[2]=s=>Z.showSelectSku=!1)},null,8,["modelValue","show","single-limit-count"])])),_:1}),f(O,{class:"detail-comment-selector",goodsId:Z.goodsInfo.id},null,8,["goodsId"]),f(T,{class:"detail-content-selector",content:Z.goodsInfo.description},null,8,["content"]),f(q,{modelValue:Z.goodsInfo,"onUpdate:modelValue":t[5]||(t[5]=s=>Z.goodsInfo=s)},{default:u((()=>[f(v,{class:"buy-box ss-flex ss-col-center ss-p-r-20"},{default:u((()=>[Z.goodsInfo.marketPrice?(m(),d(z,{key:0,class:"ss-reset-button origin-price-btn ss-flex-col",onClick:t[3]||(t[3]=s=>p(e).$router.go("/pages/goods/index",{id:Z.goodsInfo.id}))},{default:u((()=>[f(v,null,{default:u((()=>[f(v,{class:"btn-price"},{default:u((()=>[I(_(p(M)(Z.goodsInfo.marketPrice)),1)])),_:1}),f(v,null,{default:u((()=>[I("原价购买")])),_:1})])),_:1})])),_:1})):b("",!0),f(z,{class:y(["ss-reset-button btn-box ss-flex-col",0!=Z.goodsInfo.stock?"check-btn-box":"disabled-btn-box"]),onClick:t[4]||(t[4]=s=>Z.showSelectSku=!0),disabled:0===Z.goodsInfo.stock},{default:u((()=>[f(v,{class:"price-box ss-flex"},{default:u((()=>[f(l,{src:p(e).$url.static("/static/img/shop/goods/score1.svg"),style:{width:"36rpx",height:"36rpx",margin:"0 4rpx"}},null,8,["src"]),f(c,{class:"point-text ss-m-r-16"},{default:u((()=>[I(_(X.value.point)+" "+_(X.value.price&&0!==X.value.price?`+￥${X.value.price}`:""),1)])),_:1})])),_:1}),0===Z.goodsInfo.stock?(m(),d(v,{key:0},{default:u((()=>[I("已售罄")])),_:1})):(m(),d(v,{key:1},{default:u((()=>[I("立即兑换")])),_:1}))])),_:1},8,["class","disabled"])])),_:1})])),_:1},8,["modelValue"])],64))])),_:1},8,["onShareAppMessage"])}}},[["__scopeId","data-v-e682f54c"]]);export{B as default};
