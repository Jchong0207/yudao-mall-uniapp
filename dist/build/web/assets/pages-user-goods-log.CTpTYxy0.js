import{A as s,s as e,v as t,aB as a,x as l,o,r as i,e as n,f as c,w as d,u,j as r,k as p,p as f,t as g,g as m,l as _,m as x,F as S,af as h,ag as k,B as I,z as y,C as b,i as M,D as w,E as C,G as L}from"./index-B9abLD3F.js";import{_ as j}from"./s-goods-item.C5iw1xli.js";import{_ as B,S as A}from"./s-layout.Bb9KgRKE.js";import{_ as G}from"./uni-load-more.fgZWA48J.js";import{_ as v}from"./s-empty.B89PqN2E.js";import{S as N}from"./history.Dkf9iSc4.js";import{_ as z}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{l as T}from"./lodash.default.jzHPpWZq.js";import"./useGoods.CNfLrev9.js";import"./index.CAehB1O5.js";import"./min.NYZJvUqb.js";const F=z({__name:"goods-log",setup(z){s((s=>({"5c6aa578":u(F)})));const F=e.$platform.navbar,H={list:[],pageNo:1,total:1,pageSize:10},E=t({pagination:a(H),loadStatus:"",editMode:!1,selectedSpuIdList:[],selectAll:!1});async function O(){E.loadStatus="loading";const{code:s,data:e}=await N.getBrowseHistoryPage({pageNo:E.pagination.pageNo,pageSize:E.pagination.pageSize});0===s&&(E.pagination.list=T.concat(E.pagination.list,e.list),E.pagination.total=e.total,E.loadStatus=E.pagination.list.length<E.pagination.total?"more":"noMore")}const $=s=>{E.selectedSpuIdList.includes(s)?E.selectedSpuIdList.splice(E.selectedSpuIdList.indexOf(s),1):E.selectedSpuIdList.push(s),E.selectAll=E.selectedSpuIdList.length===E.pagination.list.length},D=()=>{E.selectAll=!E.selectAll,E.selectAll?E.pagination.list.forEach((s=>{E.selectedSpuIdList.includes(s.spuId)&&E.selectedSpuIdList.splice(E.selectedSpuIdList.indexOf(s.spuId),1),E.selectedSpuIdList.push(s.spuId)})):E.selectedSpuIdList=[]};async function P(){if(E.selectedSpuIdList.length<=0)return;const{code:s}=await N.deleteBrowseHistory(E.selectedSpuIdList);0===s&&W()}async function U(){const{code:s}=await N.cleanBrowseHistory();0===s&&W()}function W(){E.editMode=!1,E.selectedSpuIdList=[],E.selectAll=!1,E.pagination=H,O()}function Z(){"noMore"!==E.loadStatus&&(E.pagination.pageNo+=1,O())}return l((()=>{Z()})),o((()=>{O()})),(s,t)=>{const a=b,l=M,o=w,N=C,z=L,T=i(n("s-goods-item"),j),F=i(n("su-fixed"),B),H=i(n("uni-load-more"),G),O=i(n("s-empty"),v),W=i(n("s-layout"),A);return r(),c(W,{title:"我的足迹",bgStyle:{color:"#f2f2f2"}},{default:d((()=>[p(l,{class:"cart-box ss-flex ss-flex-col ss-row-between"},{default:d((()=>[p(l,{class:"cart-header ss-flex ss-col-center ss-row-between ss-p-x-30"},{default:d((()=>[p(l,{class:"header-left ss-flex ss-col-center ss-font-26"},{default:d((()=>[f(" 共 "),p(a,{class:"goods-number ui-TC-Main ss-flex"},{default:d((()=>[f(g(E.pagination.total),1)])),_:1}),f(" 件商品 ")])),_:1}),p(l,{class:"header-right"},{default:d((()=>[E.editMode&&E.pagination.total?(r(),c(o,{key:0,class:"ss-reset-button",onClick:t[0]||(t[0]=s=>E.editMode=!1)},{default:d((()=>[f(" 取消 ")])),_:1})):m("",!0),!E.editMode&&E.pagination.total?(r(),c(o,{key:1,class:"ss-reset-button ui-TC-Main",onClick:t[1]||(t[1]=s=>E.editMode=!0)},{default:d((()=>[f(" 编辑 ")])),_:1})):m("",!0)])),_:1})])),_:1}),p(l,{class:"cart-content"},{default:d((()=>[(r(!0),_(S,null,x(E.pagination.list,(s=>(r(),c(l,{class:"goods-box ss-r-10 ss-m-b-14",key:s.id},{default:d((()=>[p(l,{class:"ss-flex ss-col-center"},{default:d((()=>[E.editMode?(r(),c(z,{key:0,class:"check-box ss-flex ss-col-center ss-p-l-10",onClick:e=>$(s.spuId)},{default:d((()=>[p(N,{checked:E.selectedSpuIdList.includes(s.spuId),color:"var(--ui-BG-Main)",style:{transform:"scale(0.8)"},onClick:I((e=>$(s.spuId)),["stop"])},null,8,["checked","onClick"])])),_:2},1032,["onClick"])):m("",!0),p(T,{title:s.spuName,img:s.picUrl,price:s.price,skuText:s.introduction,priceColor:"#FF3000",titleWidth:400,onClick:t=>u(e).$router.go("/pages/goods/index",{id:s.spuId})},null,8,["title","img","price","skuText","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),h(p(F,{bottom:"",val:0,placeholder:""},{default:d((()=>[p(l,{class:"cart-footer ss-flex ss-col-center ss-row-between ss-p-x-30 border-bottom"},{default:d((()=>[p(l,{class:"footer-left ss-flex ss-col-center"},{default:d((()=>[p(z,{class:"check-box ss-flex ss-col-center ss-p-r-30",onClick:D},{default:d((()=>[p(N,{checked:E.selectAll,color:"var(--ui-BG-Main)",style:{transform:"scale(0.7)"},onClick:I(D,["stop"])},null,8,["checked"]),p(l,null,{default:d((()=>[f("全选")])),_:1})])),_:1})])),_:1}),p(l,{class:"footer-right ss-flex"},{default:d((()=>[p(o,{class:y(["ss-reset-button  pay-btn ss-font-28 ",{"ui-BG-Main-Gradient":E.selectedSpuIdList.length>0,"ui-Shadow-Main":E.selectedSpuIdList.length>0}]),onClick:P},{default:d((()=>[f(" 删除足迹 ")])),_:1},8,["class"]),p(o,{class:"ss-reset-button ui-BG-Main-Gradient pay-btn ss-font-28 ui-Shadow-Main ml-2",onClick:U},{default:d((()=>[f(" 清空 ")])),_:1})])),_:1})])),_:1})])),_:1},512),[[k,E.editMode]])])),_:1}),E.pagination.total>0?(r(),c(H,{key:0,status:E.loadStatus,"content-text":{contentdown:"上拉加载更多"},onClick:Z},null,8,["status"])):m("",!0),0===E.pagination.total?(r(),c(O,{key:1,text:"暂无浏览记录",icon:"/static/collect-empty.png"})):m("",!0)])),_:1})}}},[["__scopeId","data-v-b3c394d4"]]);export{F as default};
